<Page x:Class="maERP.Client.Features.Customers.Views.CustomerListPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:maERP.Client.Features.Customers.Views"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:utu="using:Uno.Toolkit.UI"
      mc:Ignorable="d"
      NavigationCacheMode="Required"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

  <Grid utu:SafeArea.Insets="VisibleBounds"
        Padding="24">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <!-- Header with Search and Add Button -->
    <Grid Grid.Row="0" Margin="0,0,0,16">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>

      <TextBox Grid.Column="0"
               Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
               PlaceholderText="Search customers..."
               Margin="0,0,12,0" />

      <Button Grid.Column="1"
              Content="Add Customer"
              Command="{Binding AddCustomer}"
              Style="{ThemeResource AccentButtonStyle}" />
    </Grid>

    <!-- Customer List -->
    <ScrollViewer Grid.Row="1">
      <ItemsRepeater ItemsSource="{Binding Customers}">
        <ItemsRepeater.ItemTemplate>
          <DataTemplate>
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,12">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Spacing="4">
                  <TextBlock Text="{Binding CompanyName}"
                             Style="{ThemeResource BodyStrongTextBlockStyle}" />
                  <TextBlock Text="{Binding Email}"
                             Style="{ThemeResource CaptionTextBlockStyle}"
                             Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                  <Button Content="Edit"
                          Command="{Binding DataContext.EditCustomer, ElementName=CustomerListPage}"
                          CommandParameter="{Binding Id}"
                          Style="{ThemeResource SubtleButtonStyle}" />
                  <Button Content="Delete"
                          Command="{Binding DataContext.DeleteCustomer, ElementName=CustomerListPage}"
                          CommandParameter="{Binding Id}"
                          Style="{ThemeResource SubtleButtonStyle}" />
                </StackPanel>
              </Grid>
            </Border>
          </DataTemplate>
        </ItemsRepeater.ItemTemplate>
      </ItemsRepeater>
    </ScrollViewer>

    <!-- Loading Indicator -->
    <ProgressRing Grid.Row="1"
                  IsActive="{Binding IsLoading}"
                  Width="50"
                  Height="50"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center" />
  </Grid>
</Page>
